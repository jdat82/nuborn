<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/* -- Provider -- */
goog.provide(&quot;nu.Utils&quot;);

/* -- Imports -- */
goog.require(&quot;nu&quot;);

<span id='nu-Utils'>/**
</span> * @class nu.Utils
 * Utilities class.
 * @singleton
 */

<span id='nu-Utils-method-isNetworkAvailable'>/**
</span> * Checks if Internet is reachable.
 * @return {Boolean} The reachability of the internet
 */
nu.Utils.isNetworkAvailable = function(){
	if(CORDOVA){
		return navigator.connection.type !== Connection.NONE;
	} else {
		return navigator.onLine;
	}
};

<span id='nu-Utils-method-isAndroid'>/**
</span> * Checks if the device platform is Android.
 * @return {Boolean} 
 */
nu.Utils.isAndroid = function(){
	if(CORDOVA){
		return device.platform === &quot;Android&quot;;
	} else {
		return navigator.userAgent.match(&quot;Android&quot;);
	}
};

<span id='nu-Utils-method-isIOS'>/**
</span> * Checks if the device platform is iOS.
 * @return {Boolean} 
 */
nu.Utils.isIOS = function(){
	if(CORDOVA){
		return device.platform === &quot;iOS&quot;;
	} else {
		return navigator.userAgent.match(/(iPhone|iPod|iPad)/i);
	}
};

<span id='nu-Utils-method-isOldAndroid'>/**
</span> * Checks if the device platform is older than Android 4.
 * @return {Boolean} 
 */
nu.Utils.isOldAndroid = function(){
	if(!nu.Utils.isAndroid()){
		return false;
	}
	return nu.Utils.getOSVersion() &lt; 4;
};

<span id='nu-Utils-method-isOldIOS'>/**
</span> * Checks if the device platform is older than iOS 5.
 * @return {Boolean}
 */
nu.Utils.isOldIOS = function(){
	if(!nu.Utils.isIOS()){
		return false;
	}
	return nu.Utils.getOSVersion() &lt; 5;
};

<span id='nu-Utils-method-getOSVersion'>/**
</span> * Gets the OS version. &lt;br/&gt;
 * Supports Phonegap - web (iOS, Android). &lt;br/&gt;
 * Needs more support.
 * @return {Boolean}
 */
nu.Utils.getOSVersion = function(){
	// if the app is running on PhoneGap, ask for the device version
	if(CORDOVA){
		return parseFloat(device.version, 10);
	} 
	// if it is a web app, ask the navigator user agent
	else {
		// getting the user agent into a local variable
		var agent = navigator.userAgent;
		// iOS case
		if(nu.Utils.isIOS()){
			// removing the first part of the user agent
			var versionIndex = agent.indexOf(&quot;OS&quot;)+2;
			agent = agent.slice(versionIndex);
			// removing the end of the user agent
			var lastIndex = agent.indexOf(&quot;)&quot;) === -1 ? 0 : agent.indexOf(&quot;)&quot;);
			agent = agent.substring(0, lastIndex);
			// replacing all underscores with points
			agent = agent.replace(/_/g, &quot;.&quot;);
			// parse the agent tg get the version as a float
			var version = parseFloat(agent);
			// returning the version
			return version;
		}
		// Android case
		else if(nu.Utils.isAndroid()) {
			// removing the first part of the user agent
			var versionIndex = agent.indexOf(&quot;Android&quot;)+7;
			agent = agent.slice(versionIndex);
			// removing the end of the user agent
			var lastIndex = agent.indexOf(&quot;;&quot;) === -1 ? 0 : agent.indexOf(&quot;;&quot;);
			agent = agent.substring(0, lastIndex);
			// parse the agent to get the version as a float
			var version = parseInt(agent);
			// returning the version
			return version;
		} else {
			return NaN;
		} 	
	}
};

<span id='nu-Utils-method-loadLazyLib'>/**
</span> * Loads JavaScript library contained in the js/lazy folder.
 * @param  {String} library The library to load
 */
nu.Utils.loadLazyLib = function(library){
	$.ajax({
		url: &quot;js/lazy/&quot;+library,
		dataType: &quot;script&quot;,
		async: false
	});
};

// handle old browsers when JSON object is missing
if(!JSON || !JSON.stringify || !JSON.parse){
	// lazy load jQuery JSON plugin
	nu.loadLazyLib(&quot;jquery.json-2.4.min.js&quot;);
	// creating JSON object
	JSON = {};
	// bind JSON stringify to jQuery JSON &quot;toJSON&quot; method
	JSON.stringify = $.toJSON || function(object){
		nu.Log.e(&quot;JSON.stringify could not be loaded : returning empty string !&quot;);
		return object instanceof Object ? &quot;{}&quot; : object instanceof Array ? &quot;[]&quot; : &quot;&quot;;
	};
	// bind JSON stringify to jQuery JSON &quot;evalJSON&quot; method
	JSON.parse = $.evalJSON || function(string){
		nu.Log.e(&quot;JSON.parse could not be loaded : returning empty object !&quot;);
		return {};
	};
}
</pre>
</body>
</html>
